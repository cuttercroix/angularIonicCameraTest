"use strict";
(self["webpackChunkapp"] = self["webpackChunkapp"] || []).push([["node_modules_capacitor-community-multilens-camerapreview_dist_esm_web_js"],{

/***/ 6682:
/*!**********************************************************************************!*\
  !*** ./node_modules/capacitor-community-multilens-camerapreview/dist/esm/web.js ***!
  \**********************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "CameraPreview": () => (/* binding */ CameraPreview),
/* harmony export */   "CameraPreviewWeb": () => (/* binding */ CameraPreviewWeb)
/* harmony export */ });
/* harmony import */ var _Users_petarkraguljac_Documents_CutterCroix_Source_Code_AngularIonicCamera_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js */ 1670);
/* harmony import */ var _capacitor_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @capacitor/core */ 5099);


/* eslint-disable @typescript-eslint/no-unused-vars */

/* eslint-disable @typescript-eslint/prefer-for-of */

/* eslint-disable @typescript-eslint/ban-types */

/* eslint-disable no-async-promise-executor */

/* eslint-disable @typescript-eslint/consistent-type-assertions */

/* eslint-disable @typescript-eslint/no-inferrable-types */

class CameraPreviewWeb extends _capacitor_core__WEBPACK_IMPORTED_MODULE_1__.WebPlugin {
  constructor() {
    super({
      name: 'CameraPreview',
      platforms: ['web']
    });
    /**
     *  track which camera is used based on start options
     *  used in capture
     */

    this.isBackCamera = false;
  }

  start(options) {
    var _this = this;

    return (0,_Users_petarkraguljac_Documents_CutterCroix_Source_Code_AngularIonicCamera_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__["default"])(function* () {
      return new Promise( /*#__PURE__*/function () {
        var _ref = (0,_Users_petarkraguljac_Documents_CutterCroix_Source_Code_AngularIonicCamera_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__["default"])(function* (resolve, reject) {
          var _a;

          yield navigator.mediaDevices.getUserMedia({
            audio: !options.disableAudio,
            video: true
          }).then(stream => {
            // Stop any existing stream so we can request media with different constraints based on user input
            stream.getTracks().forEach(track => track.stop());
          }).catch(error => {
            reject(error);
          });
          const video = document.getElementById('video');
          const parent = document.getElementById(options.parent);

          if (!video) {
            const videoElement = document.createElement('video');
            videoElement.id = 'video';
            videoElement.setAttribute('class', options.className || ''); // Don't flip video feed if camera is rear facing

            if (options.position !== 'rear') {
              videoElement.setAttribute('style', '-webkit-transform: scaleX(-1); transform: scaleX(-1);');
            }

            const userAgent = navigator.userAgent.toLowerCase();
            const isSafari = userAgent.includes('safari') && !userAgent.includes('chrome'); // Safari on iOS needs to have the autoplay, muted and playsinline attributes set for video.play() to be successful
            // Without these attributes videoElement.play() will throw a NotAllowedError
            // https://developer.apple.com/documentation/webkit/delivering_video_content_for_safari

            if (isSafari) {
              videoElement.setAttribute('autoplay', 'true');
              videoElement.setAttribute('muted', 'true');
              videoElement.setAttribute('playsinline', 'true');
            }

            if (parent) {
              parent.appendChild(videoElement);
            }

            if ((_a = navigator.mediaDevices) === null || _a === void 0 ? void 0 : _a.getUserMedia) {
              const constraints = {
                video: {
                  width: {
                    ideal: options.width
                  },
                  height: {
                    ideal: options.height
                  }
                }
              };

              if (options.position === 'rear') {
                constraints.video.facingMode = 'environment';
                _this.isBackCamera = true;
              } else {
                _this.isBackCamera = false;
              }

              navigator.mediaDevices.getUserMedia(constraints).then(function (stream) {
                //video.src = window.URL.createObjectURL(stream);
                videoElement.srcObject = stream;
                videoElement.play();
                resolve({});
              }, err => {
                reject(err);
              });
            }
          } else {
            reject({
              message: 'camera already started'
            });
          }
        });

        return function (_x, _x2) {
          return _ref.apply(this, arguments);
        };
      }());
    })();
  }

  stop() {
    return (0,_Users_petarkraguljac_Documents_CutterCroix_Source_Code_AngularIonicCamera_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__["default"])(function* () {
      const video = document.getElementById('video');

      if (video) {
        video.pause();
        const st = video.srcObject;
        const tracks = st.getTracks();

        for (let i = 0; i < tracks.length; i++) {
          const track = tracks[i];
          track.stop();
        }

        video.remove();
      }
    })();
  }

  capture(options) {
    var _this2 = this;

    return (0,_Users_petarkraguljac_Documents_CutterCroix_Source_Code_AngularIonicCamera_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__["default"])(function* () {
      return new Promise((resolve, _) => {
        const video = document.getElementById('video');
        const canvas = document.createElement('canvas'); // video.width = video.offsetWidth;

        const context = canvas.getContext('2d');
        canvas.width = video.videoWidth;
        canvas.height = video.videoHeight; // flip horizontally back camera isn't used

        if (context) {
          if (!_this2.isBackCamera) {
            context.translate(video.videoWidth, 0);
            context.scale(-1, 1);
          }

          context.drawImage(video, 0, 0, video.videoWidth, video.videoHeight);
        }

        let base64EncodedImage;

        if (options.quality != undefined) {
          base64EncodedImage = canvas.toDataURL('image/jpeg', options.quality / 100.0).replace('data:image/jpeg;base64,', '');
        } else {
          base64EncodedImage = canvas.toDataURL('image/png').replace('data:image/png;base64,', '');
        }

        resolve({
          value: base64EncodedImage
        });
      });
    })();
  }

  captureSample(_options) {
    var _this3 = this;

    return (0,_Users_petarkraguljac_Documents_CutterCroix_Source_Code_AngularIonicCamera_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__["default"])(function* () {
      return _this3.capture(_options);
    })();
  }

  getSupportedFlashModes() {
    return (0,_Users_petarkraguljac_Documents_CutterCroix_Source_Code_AngularIonicCamera_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__["default"])(function* () {
      throw new Error('getSupportedFlashModes not supported under the web platform');
    })();
  }

  getSupportedZoomLevels() {
    throw new Error('getSupportedFlashModes not supported under the web platform.');
  }

  setFlashMode(_options) {
    return (0,_Users_petarkraguljac_Documents_CutterCroix_Source_Code_AngularIonicCamera_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__["default"])(function* () {
      throw new Error('setFlashMode not supported under the web platform');
    })();
  }

  flip() {
    return (0,_Users_petarkraguljac_Documents_CutterCroix_Source_Code_AngularIonicCamera_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__["default"])(function* () {
      throw new Error('flip not supported under the web platform');
    })();
  }

  setOpacity(_options) {
    return (0,_Users_petarkraguljac_Documents_CutterCroix_Source_Code_AngularIonicCamera_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__["default"])(function* () {
      const video = document.getElementById('video');

      if (!!video && !!_options['opacity']) {
        video.style.setProperty('opacity', _options['opacity'].toString());
      }
    })();
  }

}
const CameraPreview = new CameraPreviewWeb();

(0,_capacitor_core__WEBPACK_IMPORTED_MODULE_1__.registerWebPlugin)(CameraPreview);

/***/ })

}]);
//# sourceMappingURL=node_modules_capacitor-community-multilens-camerapreview_dist_esm_web_js.js.map