{"version":3,"file":"node_modules_capacitor-community-multilens-camerapreview_dist_esm_web_js.js","mappings":"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","sources":["./node_modules/capacitor-community-multilens-camerapreview/dist/esm/web.js"],"sourcesContent":["/* eslint-disable @typescript-eslint/no-unused-vars */\n/* eslint-disable @typescript-eslint/prefer-for-of */\n/* eslint-disable @typescript-eslint/ban-types */\n/* eslint-disable no-async-promise-executor */\n/* eslint-disable @typescript-eslint/consistent-type-assertions */\n/* eslint-disable @typescript-eslint/no-inferrable-types */\nimport { WebPlugin, registerWebPlugin } from '@capacitor/core';\nexport class CameraPreviewWeb extends WebPlugin {\n    constructor() {\n        super({\n            name: 'CameraPreview',\n            platforms: ['web'],\n        });\n        /**\n         *  track which camera is used based on start options\n         *  used in capture\n         */\n        this.isBackCamera = false;\n    }\n    async start(options) {\n        return new Promise(async (resolve, reject) => {\n            var _a;\n            await navigator.mediaDevices\n                .getUserMedia({\n                audio: !options.disableAudio,\n                video: true\n            })\n                .then((stream) => {\n                // Stop any existing stream so we can request media with different constraints based on user input\n                stream.getTracks().forEach((track) => track.stop());\n            })\n                .catch((error) => {\n                reject(error);\n            });\n            const video = document.getElementById('video');\n            const parent = document.getElementById(options.parent);\n            if (!video) {\n                const videoElement = document.createElement('video');\n                videoElement.id = 'video';\n                videoElement.setAttribute('class', options.className || '');\n                // Don't flip video feed if camera is rear facing\n                if (options.position !== 'rear') {\n                    videoElement.setAttribute('style', '-webkit-transform: scaleX(-1); transform: scaleX(-1);');\n                }\n                const userAgent = navigator.userAgent.toLowerCase();\n                const isSafari = userAgent.includes('safari') && !userAgent.includes('chrome');\n                // Safari on iOS needs to have the autoplay, muted and playsinline attributes set for video.play() to be successful\n                // Without these attributes videoElement.play() will throw a NotAllowedError\n                // https://developer.apple.com/documentation/webkit/delivering_video_content_for_safari\n                if (isSafari) {\n                    videoElement.setAttribute('autoplay', 'true');\n                    videoElement.setAttribute('muted', 'true');\n                    videoElement.setAttribute('playsinline', 'true');\n                }\n                if (parent) {\n                    parent.appendChild(videoElement);\n                }\n                if ((_a = navigator.mediaDevices) === null || _a === void 0 ? void 0 : _a.getUserMedia) {\n                    const constraints = {\n                        video: {\n                            width: { ideal: options.width },\n                            height: { ideal: options.height }\n                        }\n                    };\n                    if (options.position === 'rear') {\n                        constraints.video.facingMode = 'environment';\n                        this.isBackCamera = true;\n                    }\n                    else {\n                        this.isBackCamera = false;\n                    }\n                    navigator.mediaDevices.getUserMedia(constraints).then(function (stream) {\n                        //video.src = window.URL.createObjectURL(stream);\n                        videoElement.srcObject = stream;\n                        videoElement.play();\n                        resolve({});\n                    }, (err) => {\n                        reject(err);\n                    });\n                }\n            }\n            else {\n                reject({ message: 'camera already started' });\n            }\n        });\n    }\n    async stop() {\n        const video = document.getElementById('video');\n        if (video) {\n            video.pause();\n            const st = video.srcObject;\n            const tracks = st.getTracks();\n            for (let i = 0; i < tracks.length; i++) {\n                const track = tracks[i];\n                track.stop();\n            }\n            video.remove();\n        }\n    }\n    async capture(options) {\n        return new Promise((resolve, _) => {\n            const video = document.getElementById('video');\n            const canvas = document.createElement('canvas');\n            // video.width = video.offsetWidth;\n            const context = canvas.getContext('2d');\n            canvas.width = video.videoWidth;\n            canvas.height = video.videoHeight;\n            // flip horizontally back camera isn't used\n            if (context) {\n                if (!this.isBackCamera) {\n                    context.translate(video.videoWidth, 0);\n                    context.scale(-1, 1);\n                }\n                context.drawImage(video, 0, 0, video.videoWidth, video.videoHeight);\n            }\n            let base64EncodedImage;\n            if (options.quality != undefined) {\n                base64EncodedImage = canvas.toDataURL('image/jpeg', options.quality / 100.0).replace('data:image/jpeg;base64,', '');\n            }\n            else {\n                base64EncodedImage = canvas.toDataURL('image/png').replace('data:image/png;base64,', '');\n            }\n            resolve({\n                value: base64EncodedImage,\n            });\n        });\n    }\n    async captureSample(_options) {\n        return this.capture(_options);\n    }\n    async getSupportedFlashModes() {\n        throw new Error('getSupportedFlashModes not supported under the web platform');\n    }\n    getSupportedZoomLevels() {\n        throw new Error('getSupportedFlashModes not supported under the web platform.');\n    }\n    async setFlashMode(_options) {\n        throw new Error('setFlashMode not supported under the web platform');\n    }\n    async flip() {\n        throw new Error('flip not supported under the web platform');\n    }\n    async setOpacity(_options) {\n        const video = document.getElementById('video');\n        if (!!video && !!_options['opacity']) {\n            video.style.setProperty('opacity', _options['opacity'].toString());\n        }\n    }\n}\nconst CameraPreview = new CameraPreviewWeb();\nexport { CameraPreview };\nregisterWebPlugin(CameraPreview);\n"],"names":["WebPlugin","registerWebPlugin","CameraPreviewWeb","constructor","name","platforms","isBackCamera","start","options","Promise","resolve","reject","_a","navigator","mediaDevices","getUserMedia","audio","disableAudio","video","then","stream","getTracks","forEach","track","stop","catch","error","document","getElementById","parent","videoElement","createElement","id","setAttribute","className","position","userAgent","toLowerCase","isSafari","includes","appendChild","constraints","width","ideal","height","facingMode","srcObject","play","err","message","pause","st","tracks","i","length","remove","capture","_","canvas","context","getContext","videoWidth","videoHeight","translate","scale","drawImage","base64EncodedImage","quality","undefined","toDataURL","replace","value","captureSample","_options","getSupportedFlashModes","Error","getSupportedZoomLevels","setFlashMode","flip","setOpacity","style","setProperty","toString","CameraPreview"],"sourceRoot":"webpack:///","x_google_ignoreList":[0]}